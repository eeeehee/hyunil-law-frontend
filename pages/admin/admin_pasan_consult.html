<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>?Œì‚°/?Œìƒ ?ë‹´ ê´€ë¦?- ë²•ë¬´ê·¸ë£¹ ?„ì¼</title>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css" />
    <style>
        /* [ê³µí†µ ?¤í???? ì?] */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: "Pretendard Variable", Pretendard, sans-serif; }
        body { background-color: #f5f7fa; color: #333; display: flex; min-height: 100vh; font-size:14px; }
        
        /* ?¬ì´?œë°” */
        .sidebar { width: 260px; background-color: #1a1a2e; color: #fff; padding: 30px 20px; display: flex; flex-direction: column; position: fixed; height: 100vh; left: 0; top: 0; z-index: 100; }
        .sidebar-brand { font-size: 20px; font-weight: 700; margin-bottom: 30px; padding-left: 10px; color: #fff; }
        .sidebar-menu { list-style: none; padding: 0; margin-top: 10px; }
        .menu-link { display: block; padding: 12px 15px; border-radius: 8px; color: #a6a6b5; font-size: 14px; transition: 0.2s; margin-bottom: 2px; text-decoration:none; }
        .menu-link:hover { background-color: #2c2c45; color: #fff; }
        .menu-link.active { background-color: #2c5bf2; color: #fff; font-weight: 700; }
        
        .main-content { flex: 1; margin-left: 260px; padding: 40px; }
        .page-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .page-title { font-size: 24px; font-weight: 700; color: #1a1a1a; }

        /* ?Œì´ë¸?*/
        .section-box { background: #fff; border-radius: 12px; border: 1px solid #e5e5e5; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.03); }
        .admin-table { width: 100%; border-collapse: collapse; }
        .admin-table th, .admin-table td { padding: 15px 20px; text-align: left; border-bottom: 1px solid #f0f0f0; vertical-align: middle; }
        .admin-table th { background-color: #f9f9f9; color: #555; font-weight: 600; }
        .admin-table tr:hover { background-color: #f0f7ff; cursor: pointer; }

        .badge-new { background: #ff4d4f; color: #fff; padding: 3px 8px; border-radius: 4px; font-size: 11px; font-weight: 700; }
        .badge-ing { background: #1890ff; color: #fff; padding: 3px 8px; border-radius: 4px; font-size: 11px; font-weight: 700; }
        .badge-done { background: #52c41a; color: #fff; padding: 3px 8px; border-radius: 4px; font-size: 11px; font-weight: 700; }

        /* ëª¨ë‹¬ */
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 999; justify-content: center; align-items: center; }
        .modal-card { background: #fff; width: 600px; max-height: 90vh; border-radius: 12px; padding: 30px; overflow-y: auto; position: relative; }
        .close-btn { position: absolute; top: 20px; right: 20px; font-size: 24px; cursor: pointer; }
        
        .info-row { display: flex; margin-bottom: 15px; border-bottom: 1px dashed #eee; padding-bottom: 10px; }
        .info-label { width: 120px; font-weight: 700; color: #555; }
        .info-val { flex: 1; color: #333; }
        .consult-note { width: 100%; height: 100px; padding: 10px; border: 1px solid #ddd; border-radius: 6px; resize: vertical; margin-top: 10px; }
        
        .btn-action { padding: 10px 20px; background: #2c5bf2; color: #fff; border: none; border-radius: 6px; cursor: pointer; font-weight: 700; }
        .btn-convert { background: #722ed1; margin-right: 10px; } /* ?˜ì„?„í™˜ ë²„íŠ¼ */
    </style>
</head>
<body>

<nav class="sidebar">
    <div class="sidebar-brand">ADMINISTRATOR</div>
    <ul class="sidebar-menu">
        <li><a href="/pages/admin/admin.html" class="menu-link">?“ ?ë¬¸ ê´€ë¦?/a></li>
        <li style="margin: 15px 0 5px 15px; font-size: 12px; color: #666; font-weight: 700;">?ë‹´ ?‘ìˆ˜ ê´€ë¦?(Gmail ?°ë™)</li>
        <li><a href="/pages/admin/admin_pasan_consult.html" class="menu-link active">?“‰ ?Œìƒ/?Œì‚° ?ë‹´</a></li>
        <li><a href="/pages/admin/admin_collection_consult.html" class="menu-link">?’° ì±„ê¶Œì¶”ì‹¬ ?ë‹´</a></li>
        
        <li style="margin: 15px 0 5px 15px; font-size: 12px; color: #666; font-weight: 700;">?¬ê±´ ì§„í–‰ ê´€ë¦?/li>
        <li><a href="/pages/admin/admin_pasan.html" class="menu-link">?“‰ ?Œìƒ/?Œì‚° ?¬ê±´</a></li>
        <li><a href="/index.html" class="menu-link" style="margin-top:20px;">?  ë©”ì¸?¼ë¡œ</a></li>
    </ul>
</nav>

<main class="main-content">
    <div class="page-header">
        <h2 class="page-title">?“‰ ?Œìƒ/?Œì‚° ?ë‹´ ?‘ìˆ˜ ?„í™©</h2>
        <button class="btn-action" style="background:#333;" onclick="alert('Gmail ?ë™ ?°ë™ ?€ê¸°ì¤‘ (Python)')">?“© ë©”ì¼ ?˜ë™ ê°€?¸ì˜¤ê¸?/button>
    </div>

    <div class="section-box">
        <table class="admin-table">
            <thead>
                <tr>
                    <th style="width:10%">?íƒœ</th>
                    <th style="width:12%">?‘ìˆ˜??/th>
                    <th>? ì²­???´ë¦„</th>
                    <th>?°ë½ì²?/th>
                    <th>ì´?ì±„ë¬´??/th>
                    <th>?Œë“ ?•íƒœ</th>
                    <th>ê´€ë¦?/th>
                </tr>
            </thead>
            <tbody id="listBody">
                <tr><td colspan="7" style="text-align:center; padding:30px;">ë¡œë”© ì¤?..</td></tr>
            </tbody>
        </table>
    </div>
</main>

<div id="consultModal" class="modal-overlay">
    <div class="modal-card">
        <span class="close-btn" onclick="closeModal()">??/span>
        <h3 style="margin-bottom:20px; font-size:20px; font-weight:700;">?ë‹´ ?ì„¸ ?•ë³´</h3>
        
        <div id="modalContent"></div>
        
        <h4 style="margin-top:20px; margin-bottom:10px;">?“ ?ë‹´ ë©”ëª¨</h4>
        <textarea id="adminMemo" class="consult-note" placeholder="?ë‹´ ?´ìš©??ê¸°ë¡?˜ì„¸??"></textarea>
        
        <div style="margin-top:20px; text-align:right;">
            <button class="btn-action btn-convert" onclick="convertToCase()">?? ?¬ê±´?¼ë¡œ ?„í™˜ (?˜ì„)</button>
            <button class="btn-action" onclick="saveMemo()">?€??/button>
        </div>
    </div>
</div>

<script type="module">
        import { auth, users, requireAuth, checkRole, posts, reports, payments, litigationCases, cases, leaveRequests, creditReports, expenses } from '/js/api.js';
        
        (async () => {
            if (!requireAuth()) return;
            const user = auth.getCurrentUser();
            if (!user) {
                location.href = "/pages/public/login.html";
                return;
            }

            try {
                const userData = await users.getMe();
                
                if (!checkRole(['master', 'admin', 'general_manager', 'lawyer'])) {
                    location.href = '/pages/user/dashboard.html';
                    return;
                }
                const pasanCases = await cases.getPasanCases();
                console.log('Pasan cases:', pasanCases);
            } catch (error) {
                console.error('?˜ì´ì§€ ë¡œë“œ ?ëŸ¬:', error);
                alert('?°ì´?°ë? ë¶ˆëŸ¬?¤ëŠ” ì¤??¤ë¥˜ê°€ ë°œìƒ?ˆìŠµ?ˆë‹¤.');
            }
        })();
        
        window.handleLogout = async function() {
            try {
                await auth.logout();
                location.href = "/";
            } catch (error) {
                console.error('ë¡œê·¸?„ì›ƒ ?ëŸ¬:', error);
            }
        };
    </script>
</body>
</html>
